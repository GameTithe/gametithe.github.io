---
title: "언리얼5/UE5 총 구 방향과 사격 방향 매칭시키기"
date: 2024-10-02
toc: true
categories:
  - "Tistory"
tags:
  - "tistory"
---

![](https://blog.kakaocdn.net/dna/32RX4/btsJRxyMFj0/AAAAAAAAAAAAAAAAAAAAABJzPXIJKBif0K8tP7jrXUuGOGoIlMpEhDWxvrf45lMc/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1772290799&allow_ip=&allow_referer=&signature=AyBOxyqmM4umJUtOWeSYMPpdM%2FA%3D)

빨간 Line : 총구 ~ 총구 x방향으로 쭉

주황 Line : 총구 ~ 내 에임 방향(crosshair 위치)

![](https://blog.kakaocdn.net/dna/BRCkQ/btsJPR6zQhe/AAAAAAAAAAAAAAAAAAAAAKUqzj5_qHvGWaDbECfXm660v6GTm5D6XoiTL06qMOtr/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1772290799&allow_ip=&allow_referer=&signature=kYxRPlCA7Pp7g7NKs6uNpONwuUU%3D)

일반적인 상황에서는 큰 문제는 없는데,,,,

![](https://blog.kakaocdn.net/dna/ceDw01/btsJQeUNcbO/AAAAAAAAAAAAAAAAAAAAAEzzSMsgT2b72MInPuhFS9oX4arwqoAImobe7CgJnLu9/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1772290799&allow_ip=&allow_referer=&signature=8DET7HzMBXaZi7Fg8%2BFZqDfa8EA%3D)

이렇게 우측이나 좌측으로 크게 돌렸을 때 문제가 생긴다...

**정확히 말하면 총이 회전을 안해서 이런 문제가 생긴 것이다.**

* \*\*GetSocketBoneByName\*\*은 소켓이 연결된 뼈의 이름을 가져오는 함수입니다.
* \*\*GetSocketByName\*\*은 소켓 자체의 정보를 가져오는 함수입니다.

![](https://blog.kakaocdn.net/dna/spEO9/btsJQHhK81f/AAAAAAAAAAAAAAAAAAAAAILOOvVgQMbLvjptTg7on8ktTfJ7iVjaPmZUMcDIpZQl/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1772290799&allow_ip=&allow_referer=&signature=tavALVdR%2B94xTaRlydI2TSsqB8M%3D)
![](https://blog.kakaocdn.net/dna/Bx261/btsJRBgSltK/AAAAAAAAAAAAAAAAAAAAAJ0oWn8K_QfzUoerSaNQQAyJfKCyPunf6cSBK9PsGZ8A/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1772290799&allow_ip=&allow_referer=&signature=qPE2ILK3dzdHp9Nj3JCV28DXF0c%3D)

오른 손이 socket을 두고  
그 소켓의 Transform을 가져온다.

UKismetMathLibraray를 이용해서 회전값을 가져온다.

회전값은 소켓방향이 타켓 방향을 바라보는 회전값이다.

이 값을 BP에서 사용한다.

![](https://blog.kakaocdn.net/dna/c39gBr/btsJQKr19yF/AAAAAAAAAAAAAAAAAAAAAJHTwLL3gC4yh2r9LktyQ-JAESR_1RQ-XSK49ITWp6zX/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1772290799&allow_ip=&allow_referer=&signature=V8OiXO3p0xxpM5Z%2FAC9IvW8IdJY%3D)
![](https://blog.kakaocdn.net/dna/5NnqR/btsJRB2g60X/AAAAAAAAAAAAAAAAAAAAAEO84NJ6LYrlxNPywPdCrXZ0dCOgjRhlEnP-XsiZvMyR/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1772290799&allow_ip=&allow_referer=&signature=96usGGaX1EIDOXdK2lp5Mfj8uDM%3D)

이 회전 값으로 오른 손을 돌려준다

-> 오른손도 돌아가고, 총도 돌아가고!

그럼 왼손은??

![](https://blog.kakaocdn.net/dna/bog03T/btsJQe8qgKh/AAAAAAAAAAAAAAAAAAAAAP1PP5ww5kQKj4BdNsX_8HjLWWzOrknSzJEpgkGmyW9z/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1772290799&allow_ip=&allow_referer=&signature=9gzlu4WcPIhuNi9dmKULKLISF%2Fk%3D)
![](https://blog.kakaocdn.net/dna/xS4zi/btsJQ5W2dB1/AAAAAAAAAAAAAAAAAAAAAGq7N222WiNB_J-ePp4IaE9kB0BU_QvIz2bfrPfkrFq0/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1772290799&allow_ip=&allow_referer=&signature=SBozmsnuOuklYIsntLxrNmMsUJ8%3D)

왼손을 캐릭터의 오른손 뼈 공간으로 변환시킨다.

1. TransformToBoneSpace는 특정 위치(여기서는 LeftHandTransform.GetLocation()로 얻은 위치)**를** **지정된 뼈의 로컬 공간으로 변환한다.**

2. 여기서는 왼손 소켓 위치를 오른손 뼈의 로컬 공간으로 변환하고, 그 변환 결과를 OutPosition과 OutRotation에 저장합니다.

![](https://blog.kakaocdn.net/dna/bUWHYZ/btsJQkAvRcr/AAAAAAAAAAAAAAAAAAAAAKR_IBNpvDNR575-JbtGXVcjsK86rk_FI8lFWx_RAHaT/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1772290799&allow_ip=&allow_referer=&signature=%2BpJii5FbnH0XB6cVbRsdP77HUYQ%3D)

오른손 회전하고 왼손을 오른속 로컬 공간으로 변환시키면 완료!

![](https://blog.kakaocdn.net/dna/uh65J/btsJRcaH49a/AAAAAAAAAAAAAAAAAAAAAAvNLZkBegrYYXMLZ_oEbptyP7M0leMKqfArrkdUyq3E/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1772290799&allow_ip=&allow_referer=&signature=WYWuIf55OsVwQSNttngSQYTaNpA%3D)